flowchart TB
    subgraph " "
    v0["Channel.fromFilePairs"]
    v7["ref_fasta"]
    v8["prefix"]
    v15["script1"]
    v17["script2"]
    v18["script3"]
    v24["script4"]
    end
    subgraph vzv_full_run
    subgraph VZV
    v1([FASTQC])
    v2([TRIM_ADAPT])
    v3([TRIM_4_NUCL])
    v4([TRIM_PRIMERS])
    v5([KRAKEN2])
    v9([BWA_INDEX])
    v10([BWA_MEM_BAM_SORT])
    v11([SAMTOOLS_INDEX])
    v13([SAMTOOLS_CONSENSUS])
    v14([SAMTOOLS_STATS])
    v16([RENAME_FASTA_ID])
    v19([IDENTIFY_CLADE])
    end
    v25([AGG_CLADES])
    v28([MULTIQC])
    v20(( ))
    end
    subgraph " "
    v6[" "]
    v12[" "]
    v29[" "]
    end
    v0 --> v1
    v0 --> v2
    v1 --> v20
    v2 --> v3
    v3 --> v4
    v4 --> v5
    v4 --> v10
    v5 --> v6
    v5 --> v20
    v7 --> v9
    v8 --> v9
    v9 --> v10
    v10 --> v11
    v10 --> v13
    v10 --> v14
    v11 --> v12
    v13 --> v16
    v14 --> v20
    v15 --> v16
    v16 --> v19
    v17 --> v19
    v18 --> v19
    v19 --> v20
    v24 --> v25
    v20 --> v25
    v25 --> v20
    v20 --> v28
    v28 --> v29
